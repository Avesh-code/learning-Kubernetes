
# Kubernetes Documentation  
## 1. Namespace  

* To get namespace present in our system
```bash
kubectl get namespace / ns
```
* To get list of Pods running
```bash
kubectl get pods
```
* To get the pods running in specific namespace
```bash
kubectl get pods -n <namespace-name>
```
* To create a specific namespace
```bash
kubectl create ns <namespace-name>
```
* To create a pod and run a container in pod
```bash
kubectl run <podname> --image=ngnix:latest
```
* to create a pod in specific namespace and run a container
```bash
kubectl run <podname> --image=<imagename> -n <namespace-name> 
```
* To delete a specific pod
```bash
kubectl delete pod <pod-name>
```
* To delete a specific namespace
```bash
kubectl delete ns <namespace-name>
```

### using YML file / manifest file
* creted a file called namespace.yml and it creates a namespace
```yml
kind: Namespace
apiVersion: v1
metadata:
  name: nginx
```
To run this we use :  
```bash
kubectl apply -f <ymlfile-path>
```
* then i created a file for creating a pod and running a container on it and we can use multi container too.
```yml
kind: Pod
apiVersion: v1
metadata:
  name: nginx-pod
  namespace: nginx
spec:
  containers:
    - name: nginx
      image: nginx:latest
      ports:
        - containerPort: 80
```
* then the stage of deployment so i created a deployment.yml which deploys the pods and make to use as service It is very usefull for scale the pods as we want and also give a function of rolling update.
```yml
kind: Deployment
apiVersion: apps/v1
metadata:
  name: nginx-deployment
  namespace: nginx
spec:
  replicas: 2
  selector:
     matchLabels:
       app: nginx

  template:
    metadata:
      name: nginx-dep-pod
      labels:
         app: nginx

    spec:
      containers:
        - name: nginx
          image: nginx:latest
          ports:
            - containerPort: 80
```
* Apply , get and delete
```bash
kubectl apply -f deployment.yml
kubectl get deployment -n nginx
kubectl get pods -n nginx
kubectl delete -f deployment.yml

```
* There are 2 more commands which are helpfull
- This is used to exec the container or pod 
```bash
kubectl exec -it pod/<podname> -n <namespace> -- bash 
```
- this is used describe the detailes about the pods
```bash
kubectl describe pod/<pod-name> -n <namespace>
```
### To run the YML files we used this command
```bash
kubectl apply -f <yml-file>
```

## 2. Replicas
* A Kubernetes object that ensures a stable set of pod replicas are running at any time. It manages Pods identified by matching labels based on its selector and maintains the desired number of replicas consistently.
### Replication Controller:
* An earlier Kubernetes controller that also manages the lifecycle of pod replicas, ensuring a specified number are running. It uses label selectors to identify which Pods to manage and supports scaling and self-healing by replacing failed Pods.
```yml
kind: ReplicaSet
apiVersion: apps/v1
metadata:
  name: nginx-replicasets
  namespace: nginx
spec:
  replicas: 2
  selector:
     matchLabels:
       app: nginx

  template:
    metadata:
      name: nginx-rep-pod
      labels:
         app: nginx

    spec:
      containers:
        - name: nginx
          image: nginx:latest
          ports:
            - containerPort: 80

```
* Apply and get and delete this Replicas
```bash
kubectl apply -f replicaset.yml
kubectl get replicasets -n nginx
kubectl get pods -n nginx
kubectl delete -f replicaset.yml
```
## 3. StatefulSet
* A workload API object used to manage stateful applications, providing guarantees about the ordering and uniqueness of Pods. Each Pod in a StatefulSet has a persistent identity, stable network identifiers, and stable storage, which is suitable for applications needing persistent state such as databases.
## 4. Deployment
* A higher-level concept that manages ReplicaSets and Pods. It provides declarative updates and handling of stateless applications by managing Pods and ReplicaSets, enabling rolling updates and versioning.

### label
* Key-value pairs attached to Kubernetes objects like Pods, Replication Controllers, and Services to identify and organize them. Labels facilitate grouping and selection of resources for management and scheduling purposes.
### Selector
* A mechanism that defines how to identify a set of objects using labels. It is used by controllers like ReplicaSets, Replication Controllers, and Services to select Pods they manage. Kubernetes supports equality-based selectors (key=value) and set-based selectors for more complex queries. The selector matches Pods based on their labels.
### Some Deployment Commands
* To get the deployment details like how many pods running in deployment and all.
```bash
kubectl get deployment -n <namespace-name>
```
* To Scale the deployment due to some traffic
```bash
kubctl scale deployment/<deployment-name> -n <namespace-name> --replicas=3
```
* To give a rolling update
```bash
kubectl set image deployment/<deployment-name> -n <Namespace-name> <image/pod>:<Updated-image>
```
* to delete a Deployment 
```bash
kubectl delete deployment <deployment-name> -n <namespace-name>
```
## 5. DaemonSet
* A Kubernetes DaemonSet is a controller that ensures a specific Pod runs on all or selected Nodes in a cluster. It is used to deploy node-level services that need to run on every machine or a designated subset of machines automatically. When new nodes join the cluster, the DaemonSet adds a Pod to those nodes, and when nodes are removed, the DaemonSet automatically deletes those Pods.
```yml
kind: DaemonSet
apiVersion: apps/v1
metadata:
  name: nginx-daemonsets
  namespace: nginx
spec:
  selector:
     matchLabels:
       app: nginx

  template:
    metadata:
      name: nginx-dae-pod
      labels:
         app: nginx

    spec:
      containers:
        - name: nginx
          image: nginx:latest
          ports:
            - containerPort: 80

```
* some commands:
```bash
kubectl apply -f daemonset.yml
kubectl get daemonset
kubectl get pod -n nginx
kubectl delete -f daemonset.yml
```
## 6. Jobs
* Jobs run a task once until completion
```yml
kind: Job
apiVersion: batch/v1
metadata:
  name: demo-job
  namespace: nginx
spec:
  completions: 1
  parallelism: 1
  template:
    metadata:
      name: demo-job-pod
      labels:
        app: batch-task
    spec:
      containers:
        - name: batch-container
          image: busybox
          command: ["sh","-c","echo Hello Dosto! && sleep 10"]
      restartPolicy: Never

```
* Commands:
```bash
kubectl apply -f job.yml
kubectl get job -n nginx
kubectl get pods -n nginx
kubectl logs pod/demo-job-b7pmw -n nginx
kubectl delete -f job.yml
```

## 7. CronJob
* CronJobs run tasks repeatedly on a schedule.
```yml
kind: CronJob
apiVersion: batch/v1
metadata:
  name: minute-backup
  namespace: nginx

spec:
  schedule: "*/1 * * * *"
  jobTemplate:                 # Corrected case here
    spec:
      template:
        metadata:
          name: minute-backup
          labels:
            app: minute-backup
        spec:
          restartPolicy: OnFailure    # Moved here, correct value
          containers:
            - name: backup-container
              image: busybox
              command:
                - sh
                - -c
                - >
                  echo "Backup Started" ;
                  mkdir -p /backups &&
                  mkdir -p /data &&
                  cp -r /demo-data /backups &&
                  echo "Backup Completed" ;
              volumeMounts:
                - name: data-volume
                  mountPath: /demo-data
                - name: backup-volume
                  mountPath: /backups
          volumes:
            - name: data-volume
              hostPath:
                path: /demo-data
                type: DirectoryOrCreate
            - name: backup-volume
              hostPath:
                path: /backups
                type: DirectoryOrCreate
```
* commands:
```bash
kubectl apply -f cron-job.yml
kubectl get cronjob -n nginx
kubectl get pods -n nginx
kubectl logs minute-backup-29366572-n9tw6 -n nginx
kubectl delete -f cron-job.yml 
```

